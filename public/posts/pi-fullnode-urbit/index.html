<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<meta name="theme-color" content="#333">
	<meta name="msapplication-TileColor" content="#333">
<meta itemprop="name" content="Preparing for Urbit-BTC integration with a Pi full node">
<meta itemprop="description" content="Note: Urbit&rsquo;s Bitcoin wallet was launched in May 2021. You can learn how to use it here
Introduction As you may have heard, Urbit is due to receive support for Bitcoin in th near future. Thanks to the efforts of ~timluc-miptev in fulfilling a bounty for an Urbit-native bitcoin wallet and RPC support &ndash; a suite called btc-agents &ndash; you will be able to send and receive bitcoin with other pilots on the network, by connecting your ship to a provider, which itself is connected to a bitcoin full node running the Electrs rustlang Electrum Server implementation.">
<meta itemprop="datePublished" content="2021-02-27T17:55:01-06:00" />
<meta itemprop="dateModified" content="2021-02-27T17:55:01-06:00" />
<meta itemprop="wordCount" content="2984">
<meta itemprop="image" content="https://subject.network/img/btc-header.jpg">



<meta itemprop="keywords" content="urbit,bitcoin,full.node,btc-agents,btc-provider,timluc-miptev,naltyc-wornes," />
<meta property="og:title" content="Preparing for Urbit-BTC integration with a Pi full node" />
<meta property="og:description" content="Note: Urbit&rsquo;s Bitcoin wallet was launched in May 2021. You can learn how to use it here
Introduction As you may have heard, Urbit is due to receive support for Bitcoin in th near future. Thanks to the efforts of ~timluc-miptev in fulfilling a bounty for an Urbit-native bitcoin wallet and RPC support &ndash; a suite called btc-agents &ndash; you will be able to send and receive bitcoin with other pilots on the network, by connecting your ship to a provider, which itself is connected to a bitcoin full node running the Electrs rustlang Electrum Server implementation." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://subject.network/posts/pi-fullnode-urbit/" />
<meta property="og:image" content="https://subject.network/img/btc-header.jpg" />
<meta property="article:published_time" content="2021-02-27T17:55:01-06:00" />
<meta property="article:modified_time" content="2021-02-27T17:55:01-06:00" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://subject.network/img/btc-header.jpg"/>

<meta name="twitter:title" content="Preparing for Urbit-BTC integration with a Pi full node"/>
<meta name="twitter:description" content="Note: Urbit&rsquo;s Bitcoin wallet was launched in May 2021. You can learn how to use it here
Introduction As you may have heard, Urbit is due to receive support for Bitcoin in th near future. Thanks to the efforts of ~timluc-miptev in fulfilling a bounty for an Urbit-native bitcoin wallet and RPC support &ndash; a suite called btc-agents &ndash; you will be able to send and receive bitcoin with other pilots on the network, by connecting your ship to a provider, which itself is connected to a bitcoin full node running the Electrs rustlang Electrum Server implementation."/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Preparing for Urbit-BTC integration with a Pi full node</title>
	<link rel="stylesheet" href="https://subject.network/css/style.min.5f66d6bd6751a10ba7350142ac010f4e4c42b5a3f628c93bde75a9a19d70ad5c.css" integrity="sha256-X2bWvWdRoQunNQFCrAEPTkxCtaP2KMk73nWpoZ1wrVw=" crossorigin="anonymous">
	<link rel="stylesheet" href="https://subject.network/css/override.css">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					‚è£ <a href="https://subject.network">networked subject</a>_
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://subject.network/posts/">Posts</a>
				<a href="https://subject.network/about/">About</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons"><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://subject.network/posts/">Posts</a></li>
			<li><a href="https://subject.network/about/">About</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Feb 27, 2021</span></div>
				<h1>Preparing for Urbit-BTC integration with a Pi full node</h1>
			</header>
			<div class="content">
				<p><img src="/img/btc-header.jpg" alt=""></p>
<p><strong>Note</strong>: <em>Urbit&rsquo;s Bitcoin wallet was launched in May 2021. You can learn how to use it <a href="https://subject.network/posts/btc-wallet-config/">here</a></em></p>
<h2 id="introduction">Introduction<a href="#introduction" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>As you <a href="/posts/bitcoin-with-timluc-miptev/">may have heard</a>, Urbit is due to receive support for Bitcoin in th near future. Thanks to the efforts of <code>~timluc-miptev</code> in <a href="https://github.com/timlucmiptev/btc-agents">fulfilling</a> a bounty for an Urbit-native bitcoin wallet and RPC support &ndash; a suite called <code>btc-agents</code> &ndash; you will be able to send and receive bitcoin with other pilots on the network, by connecting your ship to a provider, which itself is connected to a bitcoin full node running the <a href="https://github.com/romanz/electrs">Electrs</a> rustlang Electrum Server implementation.</p>
<p>Be sure to check out the previous interview linked above for context and details about these tools. For a quick overview of what you can expect, here are the requirements for the project from the <a href="https://grants.urbit.org/bounties/2056919898-bitcoin-full-node-provider-and-wallet">bounty</a> proposal:</p>
<blockquote>
<ul>
<li>Ships can send payment in Bitcoin to other ships.</li>
<li>Ships can send payment in Bitcoin to addresses.</li>
<li>Ships can connect to full nodes that they run on their own.</li>
<li>Ships can connect to full nodes operated by other ships.</li>
<li>Private keys are never entrusted to any other entity.</li>
<li>Ships can view the transaction history for any Bitcoin account they own.</li>
<li>Ships can view the balance of any Bitcoin account they own.</li>
</ul>
</blockquote>
<p>After interviewing <code>~timluc</code> about his work and being inspired by the efforts of <code>~nalytc-wornes</code> and the smol computing community at <a href="web+urbitgraph://group/~dasfeb/smol-computers/">~dasfeb/smol-computers</a>, I decided to expend some time and resources on putting together the requisite software and documenting the processes (and my missteps along the way) for the benefit of others who&rsquo;d like to follow suit. Be assured, this is totally possible with a small, cheap computer and a few days of fiddling over SSH (though it took me the better part of a month to get everything working). Also note: I did not use an RPi4, but you could probably follow most of these directions to do so.</p>
<p>The promise of bitcoin support on urbit is meshing the financial freedom of cryptocurrency with the true ownership of digital identity provided by urbit. The utility of programmable money is made more real by connecting BTC to the social layer of urbit address space; this is the prospect I find most exciting. Smart contracts may have gotten there first, but urbit allows for decentralized financial <a href="https://www.ribbonfarm.com/2010/10/27/warrens-plazas-and-the-edge-of-legibility/">warrens</a> &ndash; private, personally computed conditions and rules for interacting with blockchains, which aren&rsquo;t exposed to the world in the same way as an ETH contract.</p>
<p>Before we begin, a reminder: Bitcoin support has not yet been released! This is preparation for the day it happens. Your ability to issue commands will be via command line. You won&rsquo;t be able to control your full node via the Landscape UI just yet &ndash; this is all dojo, baby &ndash; but when the day comes, you&rsquo;ll be ready to roll. Alternatively, if you pilot a ship under <code>~matwet</code>, you can look forward to service from this full node in the future!</p>
<p>(Many thanks once again to <code>~timluc-miptev</code> for his patient assistance in getting things working on my end.)</p>
<h2 id="hardware">Hardware<a href="#hardware" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p><img src="/img/m4v2.jpg" alt=""></p>
<p>Thanks to the suggestion of <code>~naltyc-wornes</code>, I decided to opt for a <a href="https://www.friendlyarm.com/index.php?route=product/product&amp;product_id=268">NanoPi M4V2</a> to run my full node. This little guy is a bit beefier than an RPi, which comes in handy when you&rsquo;re doing something as CPU-intensive as block verification:</p>
<p><img src="/img/m4v2-specs.png" alt=""></p>
<p>Since this is a tiny computer, you would be right to assume that the processor is ARM. The Cortex A72 supports ARMv8, but for whatever reason I believe the OS image I used ended up only supporting ARMv7 &ndash; I unwittingly used a 32-bit OS image, which may be the reason. This did not really get in the way, but if I were doing it over, I would probably go with 64-bit.</p>
<p>The FriendlyARM page linked above includes a few optional peripherals; I got the metal case with SSD hat, as well as the power adapter. The SSD hat is critical &ndash; you will also need a 1TB M.2 SSD to store the currently ~330GB Bitcoin blockchain. Go ahead and grab a MicroSD card and reader for the boot disk as well if you don&rsquo;t already have one.</p>
<p>In addition to the above, I also purchased a 6 foot USB-C cable rated for 5A, and a pivoting camera mount &ndash; the metal case for the M4V2 includes a 1/4&rdquo; screw hole that allows you to mount it. This became more important than I expected, because it turns out that the fan on the NanoPi case is extremely loud! This can be addressed by turning it on its side &ndash; not only does heat dissipate faster, but the mechanical noise of the fan is diminished substantially. In the end, I clamped the Pi to my desk and stood it up behind my monitor.</p>
<p>For a quick breakdown on expenses:</p>
<table>
<thead>
<tr>
<th>Item</th>
<th>Cost</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://www.friendlyarm.com/index.php?route=product/product&amp;product_id=268">NanoPi M4V2</a></td>
<td>$80</td>
</tr>
<tr>
<td>Metal case + SSD hat <a href="https://www.friendlyarm.com/index.php?route=product/product&amp;product_id=268">(add-on)</a></td>
<td>$28</td>
</tr>
<tr>
<td>5V 4A power supply <a href="https://www.friendlyarm.com/index.php?route=product/product&amp;product_id=268">(add on)</a></td>
<td>$9</td>
</tr>
<tr>
<td><a href="https://www.amazon.com/Blue-SN550-1TB-NVMe-Internal/dp/B07YFFX5MD/">1TB WD Blue M.2 SSD</a></td>
<td>$104</td>
</tr>
<tr>
<td><a href="https://www.amazon.com/SanDisk-2-Pack-microSDHC-Memory-2x32GB/dp/B087JCL881/">32GB MicroSD</a></td>
<td>$12</td>
</tr>
<tr>
<td><a href="https://www.amazon.com/gp/product/B08S7BF3CG/">6Ft 5A USB-C (2x)</a></td>
<td>$15</td>
</tr>
<tr>
<td><a href="https://www.amazon.com/gp/product/B07T7KHRV7/">Pivoting camera mount w/ clamp</a></td>
<td>$14</td>
</tr>
<tr>
<td><strong>Total</strong> (not incl. shipping)</td>
<td><strong>$262</strong></td>
</tr>
</tbody>
</table>
<p>Please note that this doesn&rsquo;t need to be quite this expensive &ndash;  you really only need the Pi, power supply, SSD, SSD hat, and SD card, and you may have some of those already lying around. Here is where I also need to thank my lovely girlfriend for buying the NanoPi for me as a birthday gift &ndash; she has always been patiently supportive of me and my weird hobbies she doesn&rsquo;t care about.</p>
<p>In terms of assembly, this was not terribly difficult, though I probably should have looked at the directions since I had to take it apart twice to fix the things I did wrong &ndash; specifically:</p>
<ol>
<li>
<p>I did not realize that the little square sticker-looking thing was heat paste, and was supposed to be placed in the small square indentation above the processor&rsquo;s resting spot</p>
</li>
<li>
<p>I screwed the main board down with regular tiny screws, instead of the included spacers; the tiny screws were for mounting the SSD hat to the spacers</p>
</li>
<li>
<p>I did not initially attach the the wifi antennae to the board &ndash; this is probably easier if you do it before screwing it down. You will need to attach the tiny IPX connectors to the board by pressing them straight down on the designated spots until they click.</p>
</li>
</ol>
<p>One bit that made me nervous was (re)seating the SSD hat &ndash; it requires a bit of effort to push it down firmly enough onto the pins, to the point that I was worried about bending them. This didn&rsquo;t happen despite removing and reseating it a couple of times, though, and I definitely found it easier to do with the board screwed down to the case.</p>
<p>Eventually everything was put together and in working order:</p>
<p><img src="/img/fullnode-desk.jpg" alt=""></p>
<p>I still have this thing on wifi &ndash; I should probably plug it in for the sake of latency, but that feels a little less cool.</p>
<h2 id="the-stack">The stack<a href="#the-stack" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Let&rsquo;s have an overview of the pieces of this system:</p>
<ul>
<li>
<p>There are <a href="https://drive.google.com/drive/folders/1nFyaZ8mnfjuoXtK6gzpxVhyrdyqKtJfC">several OS images</a> available &ndash; I ended up using Lubuntu 16.04, after experimenting briefly with the other available Linux distros. As I mentioned previously, this ended up being a 32-bit image &ndash; this didn&rsquo;t end up preventing me from getting anything working, but it does prevent you from running Urbit on the same device, or allocating more than the provided 4GB of memory.</p>
</li>
<li>
<p><code>bitcoind</code> is the Bitcoin Core daemon, which syncs and checks the blockchain, and performs transactions for you. Running a <code>bitcoind</code> full node makes you an independent node on Bitcoin&rsquo;s network &ndash; you will not need to connect to somebody else&rsquo;s server in order to interact with the network, but rather simply announce your operations to the rest of the network as a peer.</p>
</li>
<li>
<p><code>electrs</code> is an implementation of <a href="https://github.com/spesmilo/electrumx">Electrum Server</a> in the Rust language &ndash; Rust is a relatively new language used for software demanding high performance and strong safety, and is meant to stand in the place of languages like C. The original Electrum and its successor are written in Python, which has significantly higher resource overhead and slower performance. For our purposes, it is a necessary mediator between <code>bitcoind</code> and Urbit&rsquo;s <code>btc-provider</code> application.</p>
</li>
<li>
<p><code>nodejs</code> is a popular Javascript framework commonly used for web development. We are going to be using it as a simple reverse proxy to act as an API for <code>electrs</code>.</p>
</li>
<li>
<p><code>btc-agents</code> is a suite of backend software for Urbit&rsquo;s Bitcoin support. It contains <code>btc-wallet</code>, which manages your Bitcoin wallets, and <code>btc-provider</code>, which communicates with a full node via a ship (yours or someone else&rsquo;s).</p>
</li>
</ul>
<p>The first three should all be running on the same device, in our case the pi &ndash; the last can run on whatever device your ship is on.</p>
<h2 id="plugging-things-in">Plugging things in<a href="#plugging-things-in" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>You&rsquo;ll need to flash the SD card with your OS image of choice; I like using <a href="https://www.balena.io/etcher/">balenaEtcher</a> for this purpose, because it&rsquo;s a simple tool that will perform error checking once it&rsquo;s finished copying.</p>
<p>Next, hook up your pi to an ethernet cable and plug it in! You can optionally use a keyboard and monitor, but I just did everything over SSH. Check your router&rsquo;s local network or do a ping scan to determine the IP address assigned to your pi, then connect over SSH with the username <code>pi</code>, password <code>pi</code>.</p>
<h3 id="ssh-config">SSH config<a href="#ssh-config" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Once you&rsquo;re connected or plugged in, first things first, let&rsquo;s change that default password!</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;passwd</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Give yourself something decent &ndash; this is potentially a high-value device!</p>
<p>Let&rsquo;s change the root password while we&rsquo;re at it (the default is <code>fa</code>):</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;passwd&nbsp;root</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Now let&rsquo;s configure SSH pubkey authentication. If you don&rsquo;t have one already, go ahead and <a href="https://www.digitalocean.com/docs/droplets/how-to/add-ssh-keys/create-with-openssh/">generate</a> an SSH key, then on your <strong>local</strong> device like your desktop, run:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;ssh-copy-id&nbsp;pi@nanopi.ip.address.here</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Now, on your pi, run the following:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;nano&nbsp;/etc/ssh/sshd_config</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This will drop you into a text editor with the configuration file for your SSH server opened; find the line that says <code>PasswordAuthentication</code> and change it to <code>no</code>, and find the line that says <code>PubkeyAuthentication</code> and make sure it says <code>yes</code>.</p>
<p>Press <code>ctrl-o</code>, <code>ctrl-x</code> to save and exit. Enter the following at the command line to restart the SSH daemon:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;systemctl&nbsp;restart&nbsp;ssh</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Get back on your other computer, and try connecting via SSH again:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;ssh&nbsp;pi@nanopi.ip.address.here</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You should be dropped right into a terminal without being prompted for the password. Nobody can connect to this pi without your keypair, so make sure to keep it safe.</p>
<p>Let&rsquo;s give our pi a cute name while we&rsquo;re here:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;hostname&nbsp;shrine</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Obviously this can be whatever you want.</p>
<h3 id="port-forwarding">Port forwarding<a href="#port-forwarding" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p><code>bitcoind</code> uses TCP port 8332 to communicate with the rest of the network by default &ndash; you will need to forward that port to your pi on your router. This process is specific to your router&rsquo;s model or manufacturer, but it&rsquo;s not very hard &ndash; you can find instructions <a href="https://www.noip.com/support/knowledgebase/general-port-forwarding-guide/">here</a>.</p>
<h3 id="mounting-your-ssd">Mounting your SSD<a href="#mounting-your-ssd" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>If your SSD is already hooked up, you will first need to partition, format, and mount it. Don&rsquo;t worry if you&rsquo;ve never done this before, because it&rsquo;s not difficult. Find the device ID using the following command:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;blkid</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This will list available devices, along with associated attributes. Look for the entry that is a 1TB drive &ndash; in my case, the device was named <code>nvme0n1</code>. Let&rsquo;s go ahead and create a partition:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;fdisk&nbsp;/dev/nvme0n1</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You will be prompted with a menu of options: press <code>p</code> to create a primary partition, then press <code>1</code> to give it a number. Once completed, enter:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;blkid&nbsp;-f</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>To view the name of the name partition &ndash; in my case, <code>/dev/nvme0n1p1</code>. Now, let&rsquo;s format the new partition in EXT4 and mount it with the label <code>bitcoin</code>:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;mkfs&nbsp;-t&nbsp;ext4&nbsp;/dev/nvme0n1p1</li>
        
        
        <li>$>&nbsp;sudo&nbsp;mount&nbsp;/dev/nvme0n1p1&nbsp;/mnt/bitcoin</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You&rsquo;re now able to <code>cd</code> into your SSD just like any other directory.</p>
<p>Let&rsquo;s make our pi automatically mount the partition on startup by editing the <code>fstab</code> file.</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;nano&nbsp;/etc/fstab</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Enter a new line at the end, and use the following:</p>
<pre><code>/dev/nvme0n1p1 /mnt/bitcoin ext4 defaults,auto,users,rw,nofail 0 0
</code></pre><p>Reboot your pi to test it; you should be able to immediately interact with <code>/mnt/bitcoin</code> once you&rsquo;re back in a terminal.</p>
<h3 id="bitcoind">bitcoind<a href="#bitcoind" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Next up, let&rsquo;s get the requisite software installed or downloaded. Let&rsquo;s grab <code>bitcoin</code> first:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;apt&nbsp;install&nbsp;curl</li>
        
        
        <li>$>&nbsp;curl&nbsp;https://bitcoin.org/bin/bitcoin-core-0.21.0/bitcoin-0.21.0-arm-linux-gnueabihf.tar.gz&nbsp;|&nbsp;tar&nbsp;xvz</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>(Note that this URL is for 32-bit ARM binaries &ndash; 64-bit binary download links are available <a href="https://bitcoin.org/en/download">here</a>.)</p>
<p>Let&rsquo;s copy the contents into <code>/usr/local/bin</code> for ease of access:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;cp&nbsp;-a&nbsp;bitcoin-0.21.0/bin/.&nbsp;/usr/local/bin</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This will come in handy so we don&rsquo;t have to type the full path to the binaries in the future. Test it out:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;bitcoind</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This should print the help menu for the <code>bitcoind</code> binary.</p>
<p>Let&rsquo;s go ahead and get started on syncing the blockchain &ndash; this will take a <em>long</em> time, at least a day &ndash; you will have to download 300GB+ of data and build an index. We&rsquo;ll do this in a tmux window so we can leave it in on the background while we work:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;apt&nbsp;install&nbsp;tmux</li>
        
        
        <li>$>&nbsp;tmux&nbsp;new&nbsp;-s&nbsp;btc</li>
        
        
        <li>$>&nbsp;mkdir&nbsp;/mnt/bitcoin/BTC</li>
        
        
        <li>$>&nbsp;bitcoind&nbsp;-datadir=/mnt/bitcoin/BTC&nbsp;-blockfilterindex&nbsp;-txindex&nbsp;-server</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Press <code>ctrl-b</code>, <code>d</code> to detach from your tmux window. You can reattach with:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;tmux&nbsp;a&nbsp;-t&nbsp;btc</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You can check on its progress periodically with this command:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;bitcoin-cli&nbsp;-datadir=/mnt/bitcoin/BTC&nbsp;getblockcount</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Compare the number it prints to the &lsquo;Height&rsquo; on <a href="https://www.blockchain.com/btc/blocks">this</a> web page &ndash; this is the current block height of the BTC blockchain. Once the two numbers are equal, you are fully synced.</p>
<h3 id="rust--electrs">Rust &amp; electrs<a href="#rust--electrs" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Next up is Rust:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;curl&nbsp;--proto&nbsp;'=https'&nbsp;--tlsv1.2&nbsp;-sSf&nbsp;https://sh.rustup.rs&nbsp;|&nbsp;sh</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This will run the installer script for Rust &ndash; <strong>don&rsquo;t</strong> slam through the defaults, we need to specify the architecture. Press &lsquo;2&rsquo; at the first prompt, then enter the host triple <code>armv7-unknown-linux-gnueabihf</code>, and choose <code>stable</code> &amp; <code>default</code>.</p>
<p>Now let&rsquo;s download <code>electrs</code> and compile it:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;apt&nbsp;install&nbsp;git&nbsp;cargo</li>
        
        
        <li>$>&nbsp;source&nbsp;$HOME/.cargo/env</li>
        
        
        <li>$>&nbsp;git&nbsp;clone&nbsp;https://github.com/romanz/electrs</li>
        
        
        <li>$>&nbsp;cd&nbsp;electrs</li>
        
        
        <li>$>&nbsp;sudo&nbsp;apt&nbsp;update&nbsp;&&&nbsp;sudo&nbsp;apt&nbsp;install&nbsp;clang&nbsp;cmake&nbsp;build-essential&nbsp;</li>
        
        
        <li>$>&nbsp;cargo&nbsp;build&nbsp;--locked&nbsp;--release</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>If all goes well, you should have some binaries waiting for you. Test it out:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;./target/release/electrs&nbsp;--help</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This should print the help menu for <code>electrs</code>.</p>
<h3 id="node">Node<a href="#node" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p>Finally, <code>nodejs</code> and <code>npm</code> &ndash; we&rsquo;re going to install it from the Node site instead of the repos, because they tend to be a bit out of date. Go find the latest ARMv7 link <a href="https://nodejs.org/en/download/">here</a>.</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;sudo&nbsp;apt&nbsp;install&nbsp;wget</li>
        
        
        <li>$>&nbsp;wget&nbsp;-c&nbsp;https://nodejs.org/dist/v14.16.0/node-v14.16.0-linux-armv7l.tar.xz</li>
        
        
        <li>$>&nbsp;tar&nbsp;xvf&nbsp;node-v14.16.0-linux-armv7l.tar.xz</li>
        
        
        <li>$>&nbsp;cd&nbsp;node-v14.16.0-linux-armv7l</li>
        
        
        <li>$>&nbsp;sudo&nbsp;cp&nbsp;-R&nbsp;*&nbsp;/usr/local/</li>
        
        
        <li>$></li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You can test to make sure it&rsquo;s installed:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;npm&nbsp;-v</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This will print the <code>npm</code> version number.</p>
<h3 id="rpc-utils">RPC utils<a href="#rpc-utils" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<p><code>~timluc-miptev</code> has put together some instructions and scripts that would have saved me a <em>lot</em> of time had I seen them before spending a week piecing things together myself; go ahead and clone his repo and check out the <a href="https://github.com/timlucmiptev/urbit-bitcoin-rpc">readme</a>:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;git&nbsp;clone&nbsp;https://github.com/timlucmiptev/urbit-bitcoin-rpc</li>
        
        
        <li>$>&nbsp;cd&nbsp;urbit-bitcoin-rpc</li>
        
        
        <li>$>&nbsp;cp&nbsp;bitcoin.conf&nbsp;/mnt/bitcoin/BTC/bitcoin.conf</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Now let&rsquo;s edit the script used to start this chain of software:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;nano&nbsp;mainnet-start.sh</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Edit the first non-commented-out line, so that it says:</p>
<pre><code>DRIVE=/mnt/bitcoin
</code></pre><p>Setting this variable will tell the rest of the script where to find your bitcoin data.</p>
<h2 id="spinning-up">Spinning up<a href="#spinning-up" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Now that everything is installed and in place, all you need to do is run the <code>mainnet-start</code> script. First, kill your existing <code>bitcoind</code> process by opening your tmux window:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;tmux&nbsp;a&nbsp;-t&nbsp;btc</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>&hellip;and pressing <code>ctrl-c</code>. It will take a few moments to shut down. Enter <code>exit</code> to close the window.</p>
<p>Now execute the startup script:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;cd&nbsp;~/urbit-bitcoin-rpc</li>
        
        
        <li>$>&nbsp;npm&nbsp;install&nbsp;express</li>
        
        
        <li>$>&nbsp;./mainnet-start.sh</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You will see some debug output churn for a while &ndash; once you see yellow text that reads <code>Electrum RPC server running on 127.0.0.1:50001</code>, that means you&rsquo;re good to go:</p>
<p><img src="/img/electrs-complete.jpg" alt=""></p>
<p>You can test <code>electrs</code> and the <code>node</code> proxy by curling a wallet query:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;curl&nbsp;http://localhost:50002/addresses/info/bc1qm7cegwfd0pvv9ypvz5nhstage00xkxevtrpshc</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This should print some JSON with info about the address in the URL.</p>
<h2 id="urbit-installation">Urbit installation<a href="#urbit-installation" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>Final steps! Let&rsquo;s spin up a fakezod, clone <code>~timluc</code>'s repo and do this:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;urbit&nbsp;-F&nbsp;zod</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Once booted, mount clay:</p>
<div class="window">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      urbit - sampel-palnet
    </div>
    <div class="termdojo">
      <ul>
        
        
        <li></li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;|mount&nbsp;%</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Open another terminal now:</p>
<div class="window" width="80%">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      terminal: ~
    </div>
    <div class="termwin">
      <ul>
        
        
        <li></li>
        
        
        <li>$>&nbsp;git&nbsp;clone&nbsp;https://github.com/timlucmiptev/btc-agents</li>
        
        
        <li>$>&nbsp;cd&nbsp;btc-agents</li>
        
        
        <li>$>&nbsp;./install.sh&nbsp;/home/[yourname]/zod</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>Now let&rsquo;s let our ship know about the new files:</p>
<div class="window">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      urbit - sampel-palnet
    </div>
    <div class="termdojo">
      <ul>
        
        
        <li></li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;|commit&nbsp;%home</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You should see the dojo print all the new file names. Continuing:</p>
<div class="window">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      urbit - sampel-palnet
    </div>
    <div class="termdojo">
      <ul>
        
        
        <li></li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;=provider&nbsp;~zod</li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;=network&nbsp;%main</li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;|start&nbsp;%btc-wallet</li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;|start&nbsp;%btc-provider</li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;:btc-wallet|command&nbsp;[%set-provider&nbsp;provider]</li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;:btc-provider|command&nbsp;[%set-credentials&nbsp;api-url='http://nanopi.ip.address.here:50002'&nbsp;network]</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>You should start seeing a spinning <code>http</code> indicator at the prompt, and eventually yellow text announcing new blocks!</p>
<p>Let&rsquo;s keep using the test commands from the readme:</p>
<div class="window">
    <div class="titlebar">
      <div class="buttons">
        <div class="bclose">
        </div>
        <div class="minimize">
        </div>
        <div class="zoom">
        </div>
      </div>
      urbit - sampel-palnet
    </div>
    <div class="termdojo">
      <ul>
        
        
        <li></li>
        
        
        <li>~sampel-palnet:dojo>&nbsp;=fprint&nbsp;[%4&nbsp;0xbeef.dead]</li>
        
        
        <li>dojo>&nbsp;=xpubmain&nbsp;'zpub6rFR7y4Q2AijBEqTUquhVz398htDFrtymD9xYYfG1m4wAcvPhXNfE3EfH1r1ADqtfSdVCToUG868RvUUkgDKf31mGDtKsAYz2oz2AGutZYs'</li>
        
        
        <li>dojo>&nbsp;:btc-wallet|command&nbsp;[%add-wallet&nbsp;xpubmain&nbsp;fprint&nbsp;~&nbsp;[~&nbsp;8]&nbsp;[~&nbsp;1]]</li>
        
        
        <li>dojo>&nbsp;.^((unit&nbsp;@ud)&nbsp;%gx&nbsp;/=btc-wallet=/balance/[xpubmain]/noun)</li>
        
        
        <li>&nbsp;</li>
        
        
        <li></li>
        
        
        <li></li>
          
      </ul>
    </div>
  </div>

<p>This should print out the balance of the test wallet (which is 0).</p>
<p><img src="/img/btc-complete.png" alt=""></p>
<p>You&rsquo;ve made it! In the future, you should only need to update the existing software on this pi to make it a provider for your ship.</p>
<p>Recall that this is still pre-release software! You won&rsquo;t be able to control your wallets from within Landscape yet. You can modify the above commands, or check out the <a href="https://github.com/timlucmiptev/btc-agents/tree/master/sur">source code</a> to get a better idea of what you can do from the dojo.</p>
<h2 id="conclusion">Conclusion<a href="#conclusion" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>If you lose power or restart your pi, you can restart the full node stack by starting the <code>mainnet-start.sh</code> script. I tried putzing around with systemd modules but just ended up breaking stuff; these will probably be part of a future iteration anyway.</p>
<p>In all, this process took me about three weeks to complete (mostly dragged out by tinkering on weekends and a couple of mishaps that required re-indexing). Knowing what I know now, it would probably take a couple of days to start over from scratch, mostly taken up by downloading and indexing 300+ GB of blockchain &ndash; if you already have a copy, this shouldn&rsquo;t take more than an afternoon. Hopefully my stumbles will help you avoid my mistakes.</p>
<h2 id="external-links">External links<a href="#external-links" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<ul>
<li>
<p><a href="https://grants.urbit.org/bounties/2056919898-bitcoin-full-node-provider-and-wallet">Bitcoin Full Node Provider and Wallet bounty</a></p>
</li>
<li>
<p><a href="https://github.com/timlucmiptev/btc-agents">~timluc-miptev&rsquo;s btc-agents repo</a></p>
</li>
<li>
<p><a href="https://github.com/timlucmiptev/urbit-bitcoin-rpc">btc-agents dependencies and scripts repo</a></p>
</li>
<li>
<p><a href="https://github.com/romanz/electrs">Electrs repo</a></p>
</li>
<li>
<p><a href="http://wiki.friendlyarm.com/wiki/index.php/NanoPi_M4V2">M4V2 documentation wiki</a></p>
</li>
<li>
<p><a href="https://github.com/kdmukai/raspi4_bitcoin_node_tutorial">RPi4 full node tutorial</a></p>
</li>
</ul>
<hr>
<p><em>This post is also available on Urbit, where you can post comments. Join <a href="web+urbitgraph://group/~matwet/networked-subject/">~matwet/networked-subject</a> and open the Networked Subject notebook.</em></p>

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://subject.network/tags/urbit">urbit</a></span><span class="tag"><a href="https://subject.network/tags/bitcoin">bitcoin</a></span><span class="tag"><a href="https://subject.network/tags/full.node">full.node</a></span><span class="tag"><a href="https://subject.network/tags/btc-agents">btc-agents</a></span><span class="tag"><a href="https://subject.network/tags/btc-provider">btc-provider</a></span><span class="tag"><a href="https://subject.network/tags/timluc-miptev">timluc-miptev</a></span><span class="tag"><a href="https://subject.network/tags/naltyc-wornes">naltyc-wornes</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2021-02-27 17:55 -0600</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://subject.network/posts/urbit-windows-docker/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>Easy Urbit on Windows with Docker Desktop</span>
			</a>
			<a class="prev-post" href="https://subject.network/posts/caddyserver-urbit-tls/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>Easy Urbit TLS with Caddy</span>
			</a>
		</div>
		<div id="comments" class="thin">
</div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="/img/by-sa.svg" height=24px width=auto></a><p> 2021 <img src="/sitful-hatred.svg" height=24px width=24px style="vertical-align:middle;"><a href="https://subject.network">~sitful-hatred</a>
		</p>
	</footer>



	<script src="https://subject.network/js/bundle.min.4a9a0ac3d2217822c7865b4161e6c2a71de1d70492264337755427898dd718f6.js" integrity="sha256-SpoKw9IheCLHhltBYebCpx3h1wSSJkM3dVQniY3XGPY=" crossorigin="anonymous"></script>
	

</body>

</html>
